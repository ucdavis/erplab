<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns:css="http://macVmlSchemaUri" xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta name=Title content="">
<meta name=Keywords content="">
<meta http-equiv=Content-Type content="text/html; charset=macintosh">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 2008">
<meta name=Originator content="Microsoft Word 2008">
<link rel=File-List href="Filtering_files/filelist.xml">
<link rel=Edit-Time-Data href="Filtering_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Stanley Huang</o:Author>
  <o:Template>Normal.dotm</o:Template>
  <o:LastAuthor>Steve Luck</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>18</o:TotalTime>
  <o:Created>2010-08-18T22:38:00Z</o:Created>
  <o:LastSaved>2010-08-18T22:38:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>1254</o:Words>
  <o:Characters>7153</o:Characters>
  <o:Company>Center for Mind and Brain</o:Company>
  <o:Lines>127</o:Lines>
  <o:Paragraphs>16</o:Paragraphs>
  <o:CharactersWithSpaces>8784</o:CharactersWithSpaces>
  <o:Version>12.0</o:Version>
 </o:DocumentProperties>
 <o:OfficeDocumentSettings>
  <o:AllowPNG/>
 </o:OfficeDocumentSettings>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:TrackMoves>false</w:TrackMoves>
  <w:TrackFormatting/>
  <w:PunctuationKerning/>
  <w:DrawingGridHorizontalSpacing>18 pt</w:DrawingGridHorizontalSpacing>
  <w:DrawingGridVerticalSpacing>18 pt</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:DontGrowAutofit/>
   <w:DontAutofitConstrainedTables/>
   <w:DontVertAlignInTxbx/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="276">
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Arial;
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Lucida Grande";
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Arial Bold";
	panose-1:2 11 7 4 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Cambria;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
h1
	{mso-style-link:"Heading 1 Char";
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:.25in;
	text-align:justify;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	mso-list:l0 level1 lfo1;
	font-size:16.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:Arial;
	mso-font-kerning:16.0pt;
	mso-bidi-font-weight:bold;}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{mso-style-noshow:yes;
	mso-style-link:"Comment Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Cambria;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
span.MsoCommentReference
	{mso-style-noshow:yes;
	mso-ansi-font-size:9.0pt;
	mso-bidi-font-size:9.0pt;}
a:link, span.MsoHyperlink
	{mso-style-noshow:yes;
	font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-noshow:yes;
	color:purple;
	text-decoration:underline;
	text-underline:single;}
p.MsoCommentSubject, li.MsoCommentSubject, div.MsoCommentSubject
	{mso-style-noshow:yes;
	mso-style-parent:"Comment Text";
	mso-style-link:"Comment Subject Char";
	mso-style-next:"Comment Text";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Cambria;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	font-weight:bold;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-noshow:yes;
	mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:9.0pt;
	font-family:"Times New Roman";
	mso-ascii-font-family:"Lucida Grande";
	mso-fareast-font-family:Cambria;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:"Lucida Grande";
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-locked:yes;
	mso-style-link:"Heading 1";
	mso-ansi-font-size:16.0pt;
	mso-bidi-font-size:16.0pt;
	font-family:Arial;
	mso-ascii-font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-hansi-font-family:Arial;
	mso-bidi-font-family:Arial;
	mso-font-kerning:16.0pt;
	font-weight:bold;}
p.paragraph, li.paragraph, div.paragraph
	{mso-style-name:paragraph;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-ascii-font-family:Cambria;
	mso-fareast-font-family:"Times New Roman";
	mso-hansi-font-family:Cambria;
	mso-bidi-font-family:"Times New Roman";}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-noshow:yes;
	mso-style-locked:yes;
	mso-style-link:"Balloon Text";
	mso-ansi-font-size:9.0pt;
	mso-bidi-font-size:9.0pt;
	font-family:"Lucida Grande";
	mso-ascii-font-family:"Lucida Grande";
	mso-hansi-font-family:"Lucida Grande";}
span.CommentTextChar
	{mso-style-name:"Comment Text Char";
	mso-style-noshow:yes;
	mso-style-locked:yes;
	mso-style-link:"Comment Text";}
span.CommentSubjectChar
	{mso-style-name:"Comment Subject Char";
	mso-style-noshow:yes;
	mso-style-locked:yes;
	mso-style-parent:"Comment Text Char";
	mso-style-link:"Comment Subject";
	mso-ansi-font-size:10.0pt;
	mso-bidi-font-size:10.0pt;
	font-weight:bold;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:1894384579;
	mso-list-template-ids:-1217787540;}
@list l0:level1
	{mso-level-start-at:12;
	mso-level-style-link:"Heading 1";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;}
@list l0:level2
	{mso-level-text:"%1\.%2\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:.55in;
	text-indent:-.55in;}
@list l0:level3
	{mso-level-text:"%1\.%2\.%3\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:.85in;
	text-indent:-.35in;}
@list l0:level4
	{mso-level-text:"%1\.%2\.%3\.%4\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:1.2in;
	text-indent:-.45in;}
@list l0:level5
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:1.55in;
	text-indent:-.55in;}
@list l0:level6
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:1.9in;
	text-indent:-.65in;}
@list l0:level7
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:2.25in;
	text-indent:-.75in;}
@list l0:level8
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.%8\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:2.6in;
	text-indent:-.85in;}
@list l0:level9
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.%8\.%9\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:3.0in;
	text-indent:-1.0in;}
@list l1
	{mso-list-id:2094816026;
	mso-list-template-ids:-1933652824;}
@list l1:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;}
@list l1:level2
	{mso-level-text:"%1\.%2\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:.55in;
	text-indent:-.55in;}
@list l1:level3
	{mso-level-text:"%1\.%2\.%3\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:.85in;
	text-indent:-.35in;}
@list l1:level4
	{mso-level-text:"%1\.%2\.%3\.%4\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:1.2in;
	text-indent:-.45in;}
@list l1:level5
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:1.55in;
	text-indent:-.55in;}
@list l1:level6
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:1.9in;
	text-indent:-.65in;}
@list l1:level7
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:2.25in;
	text-indent:-.75in;}
@list l1:level8
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.%8\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:2.6in;
	text-indent:-.85in;}
@list l1:level9
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.%8\.%9\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:3.0in;
	text-indent:-1.0in;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:minor-latin;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:minor-latin;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="3074"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<h1 align=center style='margin-left:0in;text-align:center;text-indent:0in;
mso-list:none'><a name="_Toc131136018">Filtering</a></h1>

<p class=paragraph>Filtering is a complex and often poorly understood and
incorrectly used aspect of EEG and ERP processing, and ERPLAB is designed to
make it easy for users to filter their data properly.<span style="mso-spacerun:
yes">&nbsp; </span>Filtering is done slightly differently depending on whether
you are filtering continuous EEG, epoched EEG, or averaged ERPs.<span
style="mso-spacerun: yes">&nbsp; </span>The filtering GUI looks nearly the same
for all three types of filtering, however.</p>

<p class=paragraph>ERPLAB provides three classes of filters: 1) Infinite
impulse response (IIR) Butterworth filters; 2) Finite impulse response (FIR)
filters; and Parks-McClellan notch filters.<span style="mso-spacerun:
yes">&nbsp; </span>The FIR filters are rather limited at present, and we will
increase the number of FIR options in the future (e.g., including Gaussian
impulse response functions).<span style="mso-spacerun: yes">&nbsp; </span>At
present, we recommend using the Butterworth filters for most low-pass,
high-pass, and bandpass applications and the Parks-McClellan filters for notch
filters. At present, the IIR and FIR filters are applied in both directions to
produce a zero phase-shift, noncausal filter.</p>

<p class=paragraph>To begin using a filter, you will<b style='mso-bidi-font-weight:
normal'> </b>select either (<b style='mso-bidi-font-weight:normal'>ERPLAB &gt; Filter
&amp; Frequency Tools &gt; Filters For EEG data</b> (to filter the currently
selected EEG dataset) or <b style='mso-bidi-font-weight:normal'>ERPLAB &gt; Filter
&amp; Frequency Tools &gt; Filters For ERP data</b> (to filter the currently
selected ERPset). For the IIR and FIR filters, the GUI allows you to implement
a low-pass filter, a high-pass filter, or both (implemented sequentially rather
than as a simultaneous bandpass filter).<span style="mso-spacerun: yes">&nbsp;
</span>As shown in the screenshot below, you simply specify the half-amplitude
(-6 dB) cutoff at the low end and/or at the high end, along with the order of
the filter (which determines the slope of the filter’s rolloff).<span
style="mso-spacerun: yes">&nbsp; </span>The corresponding half-power (-3 dB)
cutoff will be shown by the GUI.<span style="mso-spacerun: yes">&nbsp; </span>The
frequency response function of the filter is shown for whatever parameters you
specify.<span style="mso-spacerun: yes">&nbsp; </span>You can also select a
subset of the channels for filtering (although you will usually want to filter
all channels). </p>

<p class=paragraph><!--[if gte vml 1]><v:shapetype id="_x0000_t75" coordsize="21600,21600"
 o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f"
 stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="Picture_x0020_2" o:spid="_x0000_s1028" type="#_x0000_t75"
 style='position:absolute;margin-left:0;margin-top:0;width:431.9pt;height:294.25pt;
 z-index:1;visibility:visible;mso-wrap-style:square;mso-wrap-distance-left:9pt;
 mso-wrap-distance-top:0;mso-wrap-distance-right:9pt;
 mso-wrap-distance-bottom:0;mso-position-horizontal:absolute;
 mso-position-horizontal-relative:text;mso-position-vertical:absolute;
 mso-position-vertical-relative:text'>
 <v:imagedata src="Filtering_files/image001.png" o:title=""/>
 <v:textbox style='mso-rotate-with-shape:t'/>
 <w:wrap type="square"/>
</v:shape><![endif]--><![if !vml]><img width=434 height=296
src="Filtering_files/image002.png" align=left hspace=9 v:shapes="Picture_x0020_2"><![endif]></p>

<p class=paragraph>It is important to note that filters are a form of
controlled distortion.<span style="mso-spacerun: yes">&nbsp; </span>The more
heavily you filter your data, the more you are distorting the data (especially
the time course of the ERP waveform).<span style="mso-spacerun: yes">&nbsp;
</span>In many cases, mildly filtering the data removes a great deal of noise
while causing minimal distortion of the data, making it very worthwhile.<span
style="mso-spacerun: yes">&nbsp; </span>In most cognitive experiments, for
example, you will increase your statistical power by filtering the low
frequencies with a cutoff of 0.01&#8211;0.1 Hz and by filtering the high
frequencies with a cutoff of 20&#8211;40 Hz.<span style="mso-spacerun:
yes">&nbsp; </span>Using filters to obtain a narrower range of frequencies in
the filtered data may severely distort your data, leading you to draw incorrect
conclusions<span style="mso-spacerun: yes">&nbsp; </span>(for details, see
Chapter 5 in Luck, 2005, <i style='mso-bidi-font-style:normal'>An Introduction
to the Event-Related Potential Technique</i>).<span style="mso-spacerun:
yes">&nbsp; </span>In addition, these distortions are usually worse for filters
with steeper slopes.<span style="mso-spacerun: yes">&nbsp; </span>Thus, we
strongly recommend that you use relatively low-order filters and do not use a
low cutoff of<span style="mso-spacerun: yes">&nbsp; </span>&gt; 0.1 Hz or a
high cutoff of &lt; 20 Hz unless you have a good understanding of how filters
operate in the time domain (i.e., how filtering operates as a convolution of
the EEG/ERP waveform and the filter’s impulse response function). For an
example of how severe filtering can lead to unjustified conclusions, see Yeung
et al., 2007, <i style='mso-bidi-font-style:normal'>Psychophysiology</i>, 44,
39-49.<span style="mso-spacerun: yes">&nbsp; </span>The settings shown in the
screenshot above will be appropriate for most experiments.</p>

<p class=paragraph>Some filter settings may lead to unintended
consequences.<span style="mso-spacerun: yes">&nbsp; </span>For example, if you
select a fairly high low cutoff and a fairly low high cutoff, the filter may
end up causing significant attenuation at all frequencies.<span
style="mso-spacerun: yes">&nbsp; </span>An example of this is shown in the
screenshot below.<span style="mso-spacerun: yes">&nbsp; </span>When this
happens, the background of the frequency response function changes colors and a
warning message is shown.<span style="mso-spacerun: yes">&nbsp; </span>This
problem can often be solved by using a higher-order filter (which will yield a
steeper roll-off slope).<span style="mso-spacerun: yes">&nbsp; </span>In many
cases, you will want to use the lowest order that does not create this problem
of attenuation at all frequencies.<span style="mso-spacerun: yes">&nbsp;
</span>You can either select a higher filter order manually or select <b
style='mso-bidi-font-weight:normal'>automin</b> for the order.<span
style="mso-spacerun: yes">&nbsp; </span>If you select <b style='mso-bidi-font-weight:
normal'>automin</b>, the filtering routine will automatically determine the
lowest order that will work for the selected filter cutoffs.<span
style="mso-spacerun: yes">&nbsp; </span>This is what we recommend for most
applications.</p>

<p class=paragraph><!--[if gte vml 1]><v:shape id="Picture_x0020_4" o:spid="_x0000_s1027"
 type="#_x0000_t75" style='position:absolute;margin-left:0;margin-top:0;
 width:431.9pt;height:294.25pt;z-index:3;visibility:visible;mso-wrap-style:square;
 mso-wrap-distance-left:9pt;mso-wrap-distance-top:0;mso-wrap-distance-right:9pt;
 mso-wrap-distance-bottom:0;mso-position-horizontal:absolute;
 mso-position-horizontal-relative:text;mso-position-vertical:absolute;
 mso-position-vertical-relative:text'>
 <v:imagedata src="Filtering_files/image003.png" o:title=""/>
 <v:textbox style='mso-rotate-with-shape:t'/>
 <w:wrap type="square"/>
</v:shape><![endif]--><![if !vml]><img width=434 height=296
src="Filtering_files/image004.png" align=left hspace=9 v:shapes="Picture_x0020_4"><![endif]></p>

<p class=paragraph>The filtering GUI contains an option to remove the DC offset
before filtering.<span style="mso-spacerun: yes">&nbsp; </span>This can be
useful if you are using DC recordings and are using a high-pass filter (i.e.,
filtering out the low frequencies).<span style="mso-spacerun: yes">&nbsp;
</span>If the EEG for a given recording session has a large DC offset, a
high-pass filter will remove this offset by bring the voltage down toward
zero.<span style="mso-spacerun: yes">&nbsp; </span>This puts an
artifact&#8212;which may be enormous&#8212;into your data during the period in
which the voltage is being brought toward zero.<span style="mso-spacerun:
yes">&nbsp; </span>This problem can be solved, at least in part, by simply
subtracting the average voltage of the whole EEG waveform from each point in
the waveform before filtering.<span style="mso-spacerun: yes">&nbsp;
</span>This won’t hurt if you do not have DC recordings, so it is active by default.<span
style="mso-spacerun: yes">&nbsp; </span>This option is also available when you
filter averaged ERPs and epoched EEG data, but it is generally not a good idea
to remove the DC value in these cases (because the baseline subtraction that
has already been done in these cases is usually a better way of removing any DC
offsets).</p>

<p class=paragraph><i style='mso-bidi-font-style:normal'>Note for experts:
ERPLAB uses the Matlab <b style='mso-bidi-font-weight:normal'>filtfilt()</b>
routine to implement the filters, which results in zero phase shift (non-causal
filtering).<span style="mso-spacerun: yes">&nbsp; </span>This routine
implements a very sophisticated scheme to deal with the fact that the waveform
has a beginning and an end.<span style="mso-spacerun: yes">&nbsp; </span>That
is, filtering the points at the beginning and end of the waveform requires
using the undefined points prior to the beginning and after the end of the
waveform, and <b style='mso-bidi-font-weight:normal'>filtfilt()</b> has a way
of dealing with these points.<span style="mso-spacerun: yes">&nbsp; </span>To
be honest, we do not really understand the algorithm.<span style="mso-spacerun:
yes">&nbsp; </span>The best solution is to record several seconds of extra EEG
at the beginning and end of each trial block so that there are no undefined
points being used in the filtering of the time period you care about.<o:p></o:p></i></p>

<p class=paragraph>Filters can also produce distortions if the DC offset
changes suddenly.<span style="mso-spacerun: yes">&nbsp; </span>This can happen
if you run multiple blocks of trials, separated by pauses during which the data
are not saved in the EEG file. That is, if the DC offset gradually changes over
time, and a period of time is missing from the EEG data, then a sudden change
in offset will be present at the boundary between the nonconsecutive periods of
the recording. This can also happen when several data individual datasets are
concatenated into a single dataset.<span style="mso-spacerun: yes">&nbsp;
</span>When the ERPLAB filter tools are applied to continuous EEG data, the
filters are normally applied separately to segments of data defined by <b
style='mso-bidi-font-weight:normal'>boundary</b> events (see<a
href="Boundary_Events.htm"> the section on boundary events</a>).<span
style="mso-spacerun: yes">&nbsp; </span>Thus, you should make sure that <b
style='mso-bidi-font-weight:normal'>boundary</b> events are present whenever
there are discontinuities in the EEG data.<span style="mso-spacerun:
yes">&nbsp; </span>You can disable this in the filtering GUI, in which case
boundary events will be ignored and the filter will be applied to the entire
file as if it was a continuous data set (not recommended unless you really know
what you’re doing!).</p>

<p class=paragraph>The filtering GUI allows you to select among 3 different
types of filters.<span style="mso-spacerun: yes">&nbsp; </span>The first option
is <b style='mso-bidi-font-weight:normal'>IIR Butterworth</b>, which implements
a digital version of a Butterworth infinite impulse response filter (run in
both the forward and reverse directions to avoid a phase shift).<span
style="mso-spacerun: yes">&nbsp; </span>This is a good general-purpose
option.<span style="mso-spacerun: yes">&nbsp; </span>The second option is <b
style='mso-bidi-font-weight:normal'>FIR</b>, which uses a sinc-shaped finite
impulse response function.<span style="mso-spacerun: yes">&nbsp; </span>When
used with a relatively low order (e.g., 20), this will be a very mild filter
that produces relatively little temporal spreading of the waveform.<span
style="mso-spacerun: yes">&nbsp; </span>When used with a relatively high order
(e.g., 200), it will produce a steep roll-off, but may induce artificial oscillations
in the data.<span style="mso-spacerun: yes">&nbsp; </span>You can see this in
the filter’s impulse response function, which can be plotted instead of the
frequency response function, as shown in the following screen shot.<span
style="mso-spacerun: yes">&nbsp; </span>Note that only the right half of the
impulse response function is shown (the filter is run twice, once in this direct
and once in the opposite direction to avoid a phase shift).</p>

<p class=paragraph><!--[if gte vml 1]><v:shape id="Picture_x0020_3" o:spid="_x0000_s1026"
 type="#_x0000_t75" style='position:absolute;margin-left:0;margin-top:0;
 width:431.9pt;height:294.25pt;z-index:2;visibility:visible;mso-wrap-style:square;
 mso-wrap-distance-left:9pt;mso-wrap-distance-top:0;mso-wrap-distance-right:9pt;
 mso-wrap-distance-bottom:0;mso-position-horizontal:absolute;
 mso-position-horizontal-relative:text;mso-position-vertical:absolute;
 mso-position-vertical-relative:text'>
 <v:imagedata src="Filtering_files/image005.png" o:title=""/>
 <v:textbox style='mso-rotate-with-shape:t'/>
 <w:wrap type="square"/>
</v:shape><![endif]--><![if !vml]><img width=434 height=296
src="Filtering_files/image006.png" align=left hspace=9 v:shapes="Picture_x0020_3"><![endif]></p>

<p class=paragraph>The third filtering option is <b style='mso-bidi-font-weight:
normal'>Parks-McClellan Notch</b>, which implements a notch filter (e.g., a
filter that attenuates frequencies near 60 Hz but not lower or higher
frequencies).<span style="mso-spacerun: yes">&nbsp; </span>In most cases, we
recommend using a high-pass filter at approximately 30 Hz rather than a notch
filter to remove 60-Hz noise.</p>

<p class=MsoNormal align=center style='text-align:center'><a
href="Channel_Operations.htm"><span style='font-family:"Arial Bold";mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;&lt;Previous Section</span></a><span
style='font-family:"Arial Bold"'> <span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><a
href="ERP_Waveforms.htm"><span style='font-family:"Arial Bold";mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Next Section &gt;&gt;</span></a><span
style='font-family:"Arial Bold"'> <o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-family:"Arial Bold"'><br>
</span><a href="Manual_Cover.htm"><span style='font-family:"Arial Bold";
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Back to
Table of Contents</span></a><span style='font-family:"Arial Bold"'><o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>
